class Comment{constructor(t=null){null!==t&&(this.deleteButton=t,this.deleteComment=this.deleteComment.bind(this),this.deleteButton.addEventListener("click",()=>this.deleteComment(t))),this.addComment=this.addComment.bind(this)}addComment(t){let e=t.target,n=e.value;if(!n)return;let o=e.closest(".tasks-table__tooltip"),s=o.querySelector(".reviews"),i=document.querySelector("#comment");i.content.querySelector(".reviews__content").innerText=n;const a=document.importNode(i.content,!0);if(s)s.appendChild(a);else{let t=document.createElement("ul");t.className="reviews",t.appendChild(a),o.insertBefore(t,e)}new Comment(o.querySelector("li:last-child .reviews__delete-button")),e.value=""}deleteComment(t){let e=t.parentNode,n=e.parentNode;1!==n.childNodes.length?e.remove():n.remove()}}!function(){class t{constructor(t){this.button=t,this.handleKeyAction=this.handleKeyAction.bind(this),this.showTooltip=this.showTooltip.bind(this),t.addEventListener("click",()=>this.showTooltip(t))}showTooltip(t){let e=document.querySelector("#add-comment-tooltip"),n=t.parentElement;if(null!==n.querySelector(".tasks-table__tooltip"))return;let o=document.querySelector(".tasks-table__tooltip");null!==o&&(o.parentElement.querySelector(".tasks-table__comment-button").classList.remove("tasks-table__comment-button--pressed"),o.remove());let s=document.importNode(e.content,!0);const i=s.querySelector(".tasks-table__tooltip-input");if(n.appendChild(s),this.tooltip=i.parentNode,t.classList.contains("tasks-table__comment-button--commented")){let t=document.querySelector("#comments-list");const e=document.importNode(t.content,!0);i.parentNode.insertBefore(e,i),document.querySelectorAll(".reviews__delete-button").forEach(t=>{new Comment(t)})}i.focus(),t.classList.add("tasks-table__comment-button--pressed"),document.addEventListener("keydown",this.handleKeyAction)}handleKeyAction(t){"Escape"===t.key?(document.removeEventListener("keydown",this.handleKeyAction),this.tooltip.parentNode.removeChild(this.tooltip),this.button.classList.remove("tasks-table__comment-button--pressed")):"Enter"===t.key&&(new Comment).addComment(t)}}function e(){document.querySelectorAll(".tasks-table__comment-button").forEach(e=>{new t(e)})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):new e}(),function(){class t{constructor(){this.button=document.querySelector(".navigation__toggle-button"),this.list=document.querySelector(".navigation__list"),this.button.addEventListener("click",this.toggle.bind(this))}toggle(){this.list.classList.toggle("navigation__list--open")}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{new t}):new t}(),function(){class t{constructor(){this.togglePopup=this.togglePopup.bind(this),this.popup=document.querySelector(".popup"),null!==this.popup&&(this.backgroundOverlay=document.querySelector(".popup__background-overlay"),this.closePopupButton=document.querySelector(".popup__close-button"),this.editButton=document.querySelector(".popup__edit-button"),this.closePopupButton.addEventListener("click",this.togglePopup),this.editButton.addEventListener("click",this.togglePopup),document.addEventListener("tableSave",this.togglePopup))}togglePopup(){this.popup.classList.toggle("popup--opened"),this.backgroundOverlay.classList.toggle("popup__background-overlay--visible")}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{new t}):new t}(),function(){class t{constructor(t){this.toggleRatingTooltip=this.toggleRatingTooltip.bind(this),this.showRatingTooltip=this.showRatingTooltip.bind(this),this.hideRatingTooltip=this.hideRatingTooltip.bind(this),this.setRange=this.setRange.bind(this),this.setInputValue=this.setInputValue.bind(this),this.changeRangeBackground=this.changeRangeBackground.bind(this),this.setRatingInTd=this.setRatingInTd.bind(this),this.getPercents=this.getPercents.bind(this),this.open=!1,this.showRatingTooltipButton=t,this.showRatingTooltipButton.addEventListener("click",this.toggleRatingTooltip),document.addEventListener("closepopups",()=>{this.open&&this.hideRatingTooltip()})}toggleRatingTooltip(){this.open?this.hideRatingTooltip():this.showRatingTooltip()}hideRatingTooltip(){this.open=!1,this.showRatingTooltipButton.parentNode.querySelector(".tasks-table__rating-tooltip").remove()}getPercents(t,e,n){return 100*(t-e)/(n-e)}setRatingInTd(t){const e=this.ratingTooltip.closest(".tasks-table__column");e.querySelector(".tasks-table__rating").innerText=t;const n=e.querySelector(".tasks-table__progress span");if(5===parseInt(t))n.classList.add("tasks-table__progress--full"),n.style.width="100%";else{n.classList.remove("tasks-table__progress--full");const e=this.getPercents(t,this.min,this.max);n.style.width=`${e}%`}}showRatingTooltip(){document.dispatchEvent(new CustomEvent("closepopups")),this.open=!0;let t=document.querySelector("#rating-tooltip");const e=document.importNode(t.content,!0);this.ratingTooltip=e.querySelector(".tasks-table__rating-tooltip"),this.ratingInput=e.querySelector(".tasks-table__input-rating"),this.rangeInput=e.querySelector(".range"),this.min=this.rangeInput.getAttribute("min"),this.max=this.rangeInput.getAttribute("max");const n=this.showRatingTooltipButton.parentNode,o=n.querySelector(".tasks-table__rating");if(!o){n.querySelector(".tasks-table__no-rated-text").remove();let t=document.querySelector("#rating");const e=document.importNode(t.content,!0);n.appendChild(e)}this.rangeInput.value=null===o?3:o.innerText,this.ratingInput.value=this.rangeInput.value,this.changeRangeBackground(),this.ratingInput.addEventListener("input",this.setRange),this.rangeInput.addEventListener("input",this.setInputValue),this.rangeInput.addEventListener("mouseup",()=>{this.rangeInput.blur()}),n.appendChild(e),document.dispatchEvent(new CustomEvent("ratingChanged",{detail:this.showRatingTooltipButton}))}setRange(t){this.rangeInput.value=t.target.value,this.changeRangeBackground(),this.setRatingInTd(this.rangeInput.value),document.dispatchEvent(new CustomEvent("ratingChanged",{detail:this.rangeInput}))}setInputValue(t){this.ratingInput.value=t.target.value,this.changeRangeBackground(),this.setRatingInTd(this.ratingInput.value),document.dispatchEvent(new CustomEvent("ratingChanged",{detail:this.rangeInput}))}changeRangeBackground(){const t=this.getPercents(this.rangeInput.value,this.min,this.max);this.rangeInput.style.backgroundImage=`linear-gradient(to right, #FFD200 0%, #FFD200 ${t}%, #F0F0F0 ${t}%, #F0F0F0 100%)`}}function e(){document.querySelectorAll(".tasks-table__rate-button").forEach(e=>{new t(e)})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}(),function(){class t{constructor(){this.save=this.save.bind(this),this.saveButton=document.querySelector(".tasks-table__save-button"),null!==this.saveButton&&this.saveButton.addEventListener("click",this.save)}save(){document.dispatchEvent(new CustomEvent("tableSave")),this.saveButton.blur()}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{new t}):new t}(),function(){class t{constructor(){this.checkRatings=this.checkRatings.bind(this),document.addEventListener("ratingChanged",this.checkRatings)}getPercents(t,e,n){return 100*(t-e)/(n-e)}checkRatings(t){const e=t.detail.closest(".tasks-table__row"),n=e.querySelectorAll(".tasks-table__column:not(:last-child) .tasks-table__rating");if(n.length>3){e.classList.add("tasks-table__row--full");let t=e.lastChild.querySelector(".tasks-table__rating");if(null===t){let n=document.querySelector("#rating");const o=document.importNode(n.content,!0);e.lastChild.appendChild(o),t=e.lastChild.querySelector(".tasks-table__rating")}const o=e.lastChild.querySelector(".tasks-table__progress span"),s=Array.from(n).reduce((t,e)=>t+parseInt(e.innerHTML,10),0)/n.length;if(t.innerHTML=s.toFixed(2),5===parseInt(s,10))o.classList.add("tasks-table__progress--full"),o.style.width="100%";else{o.classList.remove("tasks-table__progress--full");const t=this.getPercents(s,1,5);o.style.width=`${t}%`}}}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{new t}):new t}(),function(){class t{constructor(){this.hoverIcons=this.hoverIcons.bind(this),this.hoverTimeLine=this.hoverTimeLine.bind(this);const t=document.querySelectorAll(".toolbar__icon-wrapper"),e=document.querySelector(".time");t.forEach(t=>t.addEventListener("touchend",this.hoverIcons)),e.addEventListener("touchend",this.hoverTimeLine)}hoverIcons(t){t.currentTarget.classList.toggle("toolbar__icon-wrapper--opened")}hoverTimeLine(){event.currentTarget.classList.toggle("time--touched")}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{new t}):new t}();
//# sourceMappingURL=script.js.map
